<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog API UI</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; background: #fafbfc; color: #222; }
    h1 { font-size: 1.5rem; }
    section { margin-bottom: 2rem; }
    form, .list { background: #fff; border: 1px solid #eee; padding: 1rem; border-radius: 6px; }
    label { display: block; margin-top: 0.5rem; }
    input, textarea { width: 100%; margin-top: 0.2rem; margin-bottom: 0.8rem; }
    button { padding: 0.5rem 1rem; border: none; background: #222; color: #fff; border-radius: 4px; cursor: pointer; }
    button:disabled { background: #aaa; }
    .item { border-bottom: 1px solid #eee; padding: 0.5rem 0; }
    .item:last-child { border-bottom: none; }
    .error { color: #b00; }
  </style>
</head>
<body>
  <h1>Blog API Minimal UI</h1>
  <section>
    <h2>Posts</h2>
    <form id="post-form">
      <label>Title <input name="title" required></label>
      <label>Content <textarea name="content" required></textarea></label>
      <button type="submit">Create Post</button>
      <span class="error" id="post-error"></span>
    </form>
    <div class="list" id="posts-list"></div>
  </section>
  <section>
    <h2>Comments</h2>
    <form id="comment-form">
      <label>Content <textarea name="content" required></textarea></label>
      <label>Author ID <input name="author_id" required></label>
      <label>Post ID <input name="post_id" required></label>
      <button type="submit">Add Comment</button>
      <span class="error" id="comment-error"></span>
    </form>
    <div class="list" id="comments-list"></div>
  </section>
  <section>
    <h2>Users</h2>
    <form id="user-form">
      <label>Name <input name="name" required></label>
      <label>Email <input name="email" required type="email"></label>
      <button type="submit">Create User</button>
      <span class="error" id="user-error"></span>
    </form>
    <div class="list" id="users-list"></div>
  </section>
  <script>
    // Helper to fetch and render posts
    async function loadPosts() {
      const res = await fetch('/posts');
      const data = await res.json();
      const list = document.getElementById('posts-list');
      list.innerHTML = (data.posts || []).map(p => `<div class="item"><b>${p.title}</b><br>${p.content}<br><small>ID: ${p.id}</small></div>`).join('') || '<em>No posts</em>';
    }
    // Helper to fetch and render comments
    async function loadComments() {
      const res = await fetch('/comments');
      const data = await res.json();
      const list = document.getElementById('comments-list');
      list.innerHTML = (data.comments || []).map(c => `<div class="item">${c.content}<br><small>By: ${c.authorId} | Post: ${c.postId} | ID: ${c.id}</small></div>`).join('') || '<em>No comments</em>';
    }
    // Helper to fetch and render users
    async function loadUsers() {
      const res = await fetch('/users');
      const data = await res.json();
      const list = document.getElementById('users-list');
      list.innerHTML = (data.users || []).map(u => `<div class="item"><b>${u.name}</b> (${u.email})<br><small>ID: ${u.id}</small></div>`).join('') || '<em>No users</em>';
    }
    // Form handlers
    document.getElementById('post-form').onsubmit = async e => {
      e.preventDefault();
      const form = e.target;
      const err = document.getElementById('post-error');
      err.textContent = '';
      const res = await fetch('/posts', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          title: form.title.value,
          content: form.content.value
        })
      });
      if (!res.ok) { err.textContent = 'Failed to create post'; return; }
      form.reset();
      loadPosts();
    };
    document.getElementById('comment-form').onsubmit = async e => {
      e.preventDefault();
      const form = e.target;
      const err = document.getElementById('comment-error');
      err.textContent = '';
      const res = await fetch('/comments', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          content: form.content.value,
          author_id: form.author_id.value,
          post_id: form.post_id.value
        })
      });
      if (!res.ok) { err.textContent = 'Failed to add comment'; return; }
      form.reset();
      loadComments();
    };
    document.getElementById('user-form').onsubmit = async e => {
      e.preventDefault();
      const form = e.target;
      const err = document.getElementById('user-error');
      err.textContent = '';
      const res = await fetch('/users', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          name: form.name.value,
          email: form.email.value
        })
      });
      if (!res.ok) { err.textContent = 'Failed to create user'; return; }
      form.reset();
      loadUsers();
    };
    // Initial load
    loadPosts();
    loadComments();
    loadUsers();
  </script>
</body>
</html>
